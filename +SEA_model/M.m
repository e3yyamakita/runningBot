function M0 = M(params,x,p)
global flags
g = params.g;

m1 = params.m1;
m2 = params.m2;
m3 = params.m3;
m4 = params.m4;
m5 = params.m5;
m6 = params.m6;
m7 = params.m7;

if flags.optimize_mw
  mw = x.mw;
else
  mw = params.mw;
end

I1 = params.i1;
I2 = params.i2;
I3 = params.i3;
I4 = params.i4;
I5 = params.i5;
I6 = params.i6;
I7 = params.i7;

l1 = params.l1;
l2 = params.l2;
l3 = params.l3;
l4 = params.l4;
l5 = params.l5;
l6 = params.l6;
l7 = params.l7;

a1 = params.a1;
a2 = params.a2;
a3 = params.a3;
a4 = params.a4;
a5 = params.a5;
a6 = params.a6;
a7 = params.a7;

c1 = params.c1;
c2 = params.c2;

q1 = x.xb;
q2 = x.yb;
q3 = x.thb;
q4 = x.lw;
q5 = x.th1;
q6 = x.th2;
q7 = x.th3;
q8 = x.th4;
q9 = x.th5;
q10 = x.th6;

dq1 = x.dxb;
dq2 = x.dyb;
dq3 = x.dthb;
dq4 = x.dlw;
dq5 = x.dth1;
dq6 = x.dth2;
dq7 = x.dth3;
dq8 = x.dth4;
dq9 = x.dth5;
dq10 = x.dth6;

%M
%    M0 = M(I1,I2,I3,I4,I5,I6,I7,A1,A2,A3,A4,A5,A6,A7,C1,C2,L1,L2,L4,L5,L7,M1,M2,M3,M4,M5,M6,M7,MW,Q3,Q4,Q5,Q6,Q7,Q8,Q9,Q10)

%    This function was generated by the Symbolic Math Toolbox version 8.7.
%    27-Nov-2023 16:39:06

t2 = cos(q3);
t3 = cos(q6);
t4 = cos(q7);
t5 = cos(q9);
t6 = cos(q10);
t7 = sin(q3);
t8 = m7+mw;
t9 = q3+q5;
t10 = q3+q8;
t11 = q6+q7;
t12 = q9+q10;
t13 = a1.^2;
t14 = a2.^2;
t15 = a3.^2;
t16 = a4.^2;
t17 = a5.^2;
t18 = a6.^2;
t19 = a7.^2;
t20 = c1.^2;
t21 = c2.^2;
t22 = l1.^2;
t23 = l2.^2;
t24 = l4.^2;
t25 = l5.^2;
t38 = -c1;
t39 = -c2;
t40 = -l7;
t41 = -q4;
t58 = a3.*c1.*m3.*2.0;
t59 = a6.*c2.*m6.*2.0;
t26 = t2.^2;
t27 = t7.^2;
t28 = mw.*t2;
t29 = cos(t9);
t30 = cos(t10);
t31 = cos(t11);
t32 = cos(t12);
t33 = mw.*t7;
t34 = q6+t9;
t35 = q9+t10;
t36 = sin(t9);
t37 = sin(t10);
t42 = a7.*m7.*t2;
t43 = a7.*m7.*t7;
t46 = t9+t11;
t47 = t10+t12;
t50 = m1.*t13;
t51 = m2.*t14;
t52 = m3.*t15;
t53 = m4.*t16;
t54 = m5.*t17;
t55 = m6.*t18;
t56 = m3.*t20;
t57 = m6.*t21;
t60 = m2.*t22;
t61 = m3.*t22;
t62 = m3.*t23;
t63 = m5.*t24;
t64 = m6.*t24;
t65 = m6.*t25;
t66 = a2.*l1.*m2.*t3;
t67 = a3.*l2.*m3.*t4;
t68 = a5.*l4.*m5.*t5;
t69 = a6.*l5.*m6.*t6;
t70 = c1.*l2.*m3.*t4;
t71 = c2.*l5.*m6.*t6;
t74 = l1.*l2.*m3.*t3;
t75 = l4.*l5.*m6.*t5;
t78 = a3+t38;
t79 = a6+t39;
t82 = -t58;
t83 = -t59;
t86 = 1.0./t8.^2;
t87 = l7+t41;
t115 = a7+q4+t40;
t124 = l2.*m3.*t4.*t38;
t126 = l5.*m6.*t6.*t39;
t142 = m1+m2+m3+m4+m5+m6+t8;
t44 = cos(t34);
t45 = cos(t35);
t48 = sin(t34);
t49 = sin(t35);
t72 = l1.*t29;
t73 = l4.*t30;
t76 = l1.*t36;
t77 = l4.*t37;
t80 = cos(t46);
t81 = cos(t47);
t84 = sin(t46);
t85 = sin(t47);
t88 = -t28;
t89 = -t33;
t90 = -t43;
t91 = t66.*2.0;
t92 = t67.*2.0;
t93 = t68.*2.0;
t94 = t69.*2.0;
t95 = t70.*2.0;
t96 = t71.*2.0;
t99 = t74.*2.0;
t100 = t75.*2.0;
t103 = a1.*m1.*t29;
t104 = a4.*m4.*t30;
t109 = a1.*m1.*t36;
t110 = a4.*m4.*t37;
t116 = a3.*l1.*m3.*t31;
t117 = a6.*l4.*m6.*t32;
t118 = c1.*l1.*m3.*t31;
t119 = c2.*l4.*m6.*t32;
t136 = t87.^2;
t141 = t115.^2;
t145 = t28.*t87;
t146 = l1.*m3.*t31.*t38;
t148 = l4.*m6.*t32.*t39;
t150 = t33.*t87;
t202 = I3+t52+t56+t67+t82+t124;
t203 = I6+t55+t57+t69+t83+t126;
t97 = t72.*2.0;
t98 = t73.*2.0;
t101 = t76.*2.0;
t102 = t77.*2.0;
t105 = a2.*t44;
t106 = a5.*t45;
t107 = l2.*t44;
t108 = l5.*t45;
t111 = a2.*t48;
t112 = a5.*t49;
t113 = l2.*t48;
t114 = l5.*t49;
t125 = -t95;
t127 = -t96;
t137 = t116.*2.0;
t138 = t117.*2.0;
t139 = t118.*2.0;
t140 = t119.*2.0;
t143 = -t109;
t144 = -t110;
t153 = t87.*t89;
t154 = t78.*t80;
t155 = t79.*t81;
t156 = t78.*t84;
t157 = t79.*t85;
t210 = t116+t146+t202;
t211 = t117+t148+t203;
t120 = m2.*t105;
t121 = m5.*t106;
t122 = m2.*t111;
t123 = m5.*t112;
t128 = t105.*2.0;
t129 = t106.*2.0;
t130 = t107.*2.0;
t131 = t108.*2.0;
t132 = t111.*2.0;
t133 = t112.*2.0;
t134 = t113.*2.0;
t135 = t114.*2.0;
t147 = -t139;
t149 = -t140;
t158 = t154.*2.0;
t159 = t155.*2.0;
t160 = t156.*2.0;
t161 = t157.*2.0;
t162 = t72+t105;
t163 = t73+t106;
t164 = t76+t111;
t165 = t77+t112;
t166 = m3.*t154;
t167 = m6.*t155;
t168 = m3.*t156;
t169 = m6.*t157;
t188 = t72+t107+t154;
t189 = t73+t108+t155;
t190 = t76+t113+t156;
t191 = t77+t114+t157;
t212 = I2+I3+t51+t52+t56+t62+t66+t74+t82+t92+t116+t125+t146;
t213 = I5+I6+t54+t55+t57+t65+t68+t75+t83+t94+t117+t127+t148;
t151 = -t122;
t152 = -t123;
t170 = m2.*t162;
t171 = m5.*t163;
t172 = m2.*t164;
t173 = m5.*t165;
t174 = t97+t128;
t175 = t98+t129;
t176 = t101+t132;
t177 = t102+t133;
t178 = -t168;
t179 = -t169;
t192 = m3.*t190;
t193 = m6.*t191;
t194 = m3.*t188;
t195 = m6.*t189;
t196 = t97+t130+t158;
t197 = t98+t131+t159;
t198 = t101+t134+t160;
t199 = t102+t135+t161;
t214 = I1+I2+I3+t50+t51+t52+t56+t60+t61+t62+t82+t91+t92+t99+t125+t137+t147;
t215 = I4+I5+I6+t53+t54+t55+t57+t63+t64+t65+t83+t93+t94+t100+t127+t138+t149;
t180 = -t172;
t181 = -t173;
t182 = (m2.*t174)./2.0;
t183 = (m5.*t175)./2.0;
t184 = (m2.*t176)./2.0;
t185 = (m5.*t177)./2.0;
t200 = -t192;
t201 = -t193;
t204 = (m3.*t198)./2.0;
t205 = (m6.*t199)./2.0;
t206 = (m3.*t196)./2.0;
t207 = (m6.*t197)./2.0;
t186 = -t184;
t187 = -t185;
t208 = -t204;
t209 = -t205;
mt1 = [t142,0.0,t90+t143+t144+t153+t180+t181+t200+t201,t88,t143+t180+t200,t151-m3.*(t113+t156),t178,t144+t181+t201,t152-m6.*(t114+t157),t179,0.0,t142,t42+t103+t104+t145+t170+t171+t194+t195,t89,t103+t170+t194,t120+m3.*(t107+t154),t166,t104+t171+t195,t121+m6.*(t108+t155),t167,t90+t143+t144+t153+t186+t187+t208+t209,t42+t103+t104+t145+t182+t183+t206+t207,I1+I2+I3+I4+I5+I6+I7+t162.*t170+t163.*t171+t164.*t172+t165.*t173+t188.*t194+t190.*t192+t189.*t195+t191.*t193+t29.^2.*t50+t30.^2.*t53+t36.^2.*t50+t37.^2.*t53+m7.*t19.*t26+m7.*t19.*t27+mw.*t26.*t136+mw.*t27.*t136+m7.*mw.^2.*t86.*t141+m7.^2.*mw.*t86.*t141,0.0,t214,t212,t210,t215,t213,t211,t88,t89,0.0,mw,0.0,0.0,0.0,0.0,0.0,0.0,t143+t186+t208];
mt2 = [t103+t182+t206,t214,0.0,t214,t212,t210,0.0,0.0,0.0,t151-(m3.*(t134+t160))./2.0,t120+(m3.*(t130+t158))./2.0,t212,0.0,t212,I2+I3+t51+t52+t56+t62+t82+t92+t125,t202,0.0,0.0,0.0,t178,t166,t210,0.0,t210,t202,I3+t52+t56+t82,0.0,0.0,0.0,t144+t187+t209,t104+t183+t207,t215,0.0,0.0,0.0,0.0,t215,t213,t211,t152-(m6.*(t135+t161))./2.0,t121+(m6.*(t131+t159))./2.0,t213,0.0,0.0,0.0,0.0,t213,I5+I6+t54+t55+t57+t65+t83+t94+t127,t203,t179,t167,t211,0.0,0.0,0.0,0.0,t211,t203,I6+t55+t57+t83];
M0 = reshape([mt1,mt2],10,10);
